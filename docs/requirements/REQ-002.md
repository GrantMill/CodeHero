---
id: REQ-002
title: Orchestrator LLM (Generalist with Tool Use)
status: draft
start: 2025-10-20
# end: 2025-11-10
---
As a user, I can talk naturally to a general AI (the Orchestrator) that answers questions and, when needed, plans and executes allowed tools to get things done in this repo.

Design notes
- Orchestrator is an LLM-backed `IAgentService` implementation.
- Two modes: Answer-only (no tools) and Plan+Act (uses MCP tools via IMcpClient).
- Tool allowlist: fs/list, fs/readText, fs/writeText, scribe/createRequirement (extendable).
- Plans are explained to the user before potentially destructive steps; user can approve/decline.

Acceptance
- [ ] Prompting: system + developer prompts define role, safety rules, and tool policies.
- [ ] Tool schema: each MCP tool exposed with name, description, and JSON parameters for the LLM.
- [ ] Planner: given a user request, the LLM returns a structured plan (steps with tool calls).
- [ ] Executor: executes plan with IMcpClient; collects results and summarizes back to the user.
- [ ] Guardrails: approval gate for write operations, and a dry-run display showing diffs/previews.
- [ ] Fallback: if planning fails, Orchestrator answers conversationally without tools.
- [ ] Telemetry: traces show plan, tool calls, durations, and outcomes (PII-safe).
