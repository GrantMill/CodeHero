---
id: REQ-004
title: MCP Tooling for Code Changes (Plan, Edit, Diff)
status: draft
---
As a user, I can request code changes in natural language; the Orchestrator plans and applies edits via MCP tools that operate on files in this repo.

Design notes
- New MCP tools: `code/plan`, `code/edit`, `code/diff`, `code/format`, `code/test`.
- Plans represent a sequence of edits per file; each edit includes a patch-like hunk with context.
- Executor applies edits via FileStore or a safe patching engine; validates build/tests; reports diffs.
- Guardrails: only modifies files under allowed roots; requires approval for changes spanning >N files.

Acceptance
- [ ] Implement `code/diff` that computes unified diffs for changed files.
- [ ] Implement `code/edit` that writes validated patches to disk.
- [ ] Add `code/test` tool to run subset of tests and collect results.
- [ ] Orchestrator integrates these tools into planning and execution.
- [ ] User can approve plan/edits before apply (interactive).
